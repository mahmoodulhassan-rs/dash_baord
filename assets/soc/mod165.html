<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="Author" content="<username>"> <meta name="GENERATOR" content="urg/version [en] (platform name) [urg]">
<title>Unified Coverage Report :: Module :: edma_tx_sched</title>
<link type="text/css" rel="stylesheet" href="css/.urg.css">
<link type="text/css" rel="stylesheet" href="css/.layout.css">
<link type="text/css" rel="stylesheet" href="css/.breadcrumb.css">
<script type="text/javascript" src="js/.jquery.js"></script>
<script type="text/javascript" src="js/.jquery-ui.js"></script>
<script type="text/javascript" src="js/.sortable.js"></script>
<script type="text/javascript" src="js/.layout.js"></script>
<script type="text/javascript" src="js/.breadcrumb.js"></script>
<script type="text/javascript">
var layout, westLayout, centerLayout;
$(document).ready(function () {
  if ($("#north-bread-crumb")) {
    $("#north-bread-crumb").jBreadCrumb({easing:'swing'})
  }
  layout = $("body").layout({ 
    resizable: true,
    spacing_open: 4,
    spacing_closed: 4,
    north: {
      size: 76
    },
    south: {
      size: 45,
      initClosed: true
    },
    west: {
      size: 500,
      resizable: true,
      initClosed: false
    }
  });
  centerLayout = $('div.ui-layout-center').layout({
    north__paneSelector: ".ui-layout-center-inner-north",
    center__paneSelector: ".ui-layout-center-inner-center", 
    north__size: 50,
    spacing_open: 4,
    spacing_closed: 4
  });
});
</script>
</head>
<body onLoad="initPage();"><div class="ui-layout-north">
<div class="logo"></div>
<center class="pagetitle">Module Definition</center>
<div align="center"><a href="dashboard.html" ><b>dashboard</b></a> | <a href="hierarchy.html" ><b>hierarchy</b></a> | <a href="modlist.html" ><b>modlist</b></a> | groups | <a href="tests.html" ><b>tests</b></a> | <a href="asserts.html" ><b>asserts</b></a></div>

</div>
<div class="ui-layout-west">
<div name='tag_edma_tx_sched'>
<div class=modhdr>
<br clear=all>
<span class=titlename>Module : <a href="#"  onclick="showContent('tag_edma_tx_sched')">edma_tx_sched</a></span>
<br clear=all>
<table align=left>
<tr class="sortablehead">
<td>SCORE</td><td>LINE</td><td>COND</td><td>TOGGLE</td><td>FSM</td><td>BRANCH</td><td>ASSERT</td></tr><tr>
<td class="s3 cl rt"> 38.68</td>
<td class="s7 cl rt"><a href="mod165.html#Line" > 72.13</a></td>
<td class="s2 cl rt"><a href="mod165.html#Cond" > 27.27</a></td>
<td class="s0 cl rt"><a href="mod165.html#Toggle" >  3.48</a></td>
<td class="wht cl rt"></td>
<td class="s5 cl rt"><a href="mod165.html#Branch" > 51.85</a></td>
<td class="wht cl rt"></td>
</tr></table><br clear=all>
<span class=repname>Source File(s) : </span>
<br clear=all>
<a href="javascript:void(0);"  onclick="openSrcFile('/nfs_project/gemini/DV/nadeem/dv/night_reg/gemini/design/ip/GbE/hdl/edma_tx_sched.v')">/nfs_project/gemini/DV/nadeem/dv/night_reg/gemini/design/ip/GbE/hdl/edma_tx_sched.v</a><br clear=all>
<br clear=all>
<span class=repname>Module self-instances :</span>
<br clear=all>
<table align=left>
<tr class="sortablehead">
<td class="alfsrt">NAME</td><td>SCORE</td><td>LINE</td><td>COND</td><td>TOGGLE</td><td>FSM</td><td>BRANCH</td><td>ASSERT</td></tr><tr>
<td class="wht cl wordwrap"><a href="mod165.html#inst_tag_13366"  onclick="showContent('inst_tag_13366')">config_ss_tb.DUT.config_ss.gbe_u.gem_top_u.i_gem_ss.i_gem_top.i_gem_mac.i_gem_tx_wrap.gen_tx_fifo_interface.i_gem_tx_fifo_if.i_edma_tx_sched<img src="fx.gif" class="icon"></a></td>
<td class="wht cl rt"></td>
<td class="wht cl rt"></td>
<td class="wht cl rt"></td>
<td class="wht cl rt"></td>
<td class="wht cl rt"></td>
<td class="wht cl rt"></td>
<td class="wht cl rt"></td>
</tr></table></div>
</div>
<br clear=all>
</div>
<div class="ui-layout-center">
<div class="ui-layout-center-inner-center">
<div name='tag_edma_tx_sched'>
<a name="Line"></a>
Line Coverage for Module : <a href="mod165.html" >edma_tx_sched</a><br clear=all>
<table class="noborder">
<col width="122">
<col span="4" width="82">
<tr><th></th><th>Line No.</th><th>Total</th><th>Covered</th><th>Percent</th></tr>
<tr class="s7"><td class="lf">TOTAL</td><td></td><td>61</td><td>44</td><td>72.13</td></tr>
<tr class="s6"><td class="lf">ALWAYS</td><td>160</td><td>18</td><td>11</td><td>61.11</td></tr>
<tr class="s7"><td class="lf">ALWAYS</td><td>216</td><td>5</td><td>4</td><td>80.00</td></tr>
<tr class="s6"><td class="lf">ALWAYS</td><td>226</td><td>12</td><td>8</td><td>66.67</td></tr>
<tr class="s8"><td class="lf">ALWAYS</td><td>254</td><td>6</td><td>5</td><td>83.33</td></tr>
<tr class="s7"><td class="lf">ALWAYS</td><td>274</td><td>11</td><td>8</td><td>72.73</td></tr>
<tr class="s8"><td class="lf">ALWAYS</td><td>310</td><td>9</td><td>8</td><td>88.89</td></tr>
</table>
<pre class="code"><br clear=all>
159                           // repeat process for every queue ...
160        1/1                  deficit_cntr_rst[i2] = 1'b0;
161                     
162                             // If the gatestate is low, or the allowed number of bytes from the 802.1Qbv module is
163                             // less than the frame size, then do not permit transmission
164        1/1                  if (!gatestate[i2] | ({byte_count_arr[i2]} &lt; {5'b00000,nxt_frame_size[i2]}))
165                             begin
166        <font color = "red">0/1     ==>            queue_can_tx[i2] = 1'b0;</font>
167        <font color = "red">0/1     ==>            deficit_cntr_rst[i2] = (!packets_in_q[i2]);</font>
168                             end
169                     
170                             // If there are no frames to transmit, then we cannot transmit obviously ...
171                             // We also need to reset the deficit counters if there are no frames ...
172        1/1                  else if (!packets_in_q[i2])
173                             begin
174        1/1                    queue_can_tx[i2] = 1'b0;
175        1/1                    deficit_cntr_rst[i2] = 1'b1;
176                             end
177                     
178                             // CBS Specific
179                             // If CBS is enabled on the top queue, then only allow transmission to
180                             // continue if the CBS module permits it ...
181        1/1                  else if (cbs_q_a_id == i2[3:0] &amp; cbs_enable_q_a)
182        <font color = "red">0/1     ==>            queue_can_tx[i2] = cbs_queue[0];</font>
183                     
184                             // If CBS is enabled on 2nd top queue, then only allow transmission to
185                             // continue if the CBS module permits it ...
186        1/1                  else if (cbs_q_b_id == i2[3:0] &amp; cbs_enable_q_b)
187        <font color = "red">0/1     ==>            queue_can_tx[i2] = cbs_queue[1];</font>
188                     
189                             // Have we previously said we can send a frame on this queue and are still waiting for it to be serviced ?
190                             // If so, then we can transmit
191        1/1                  else if (queue_can_tx_str[i2])
192        <font color = "red">0/1     ==>            queue_can_tx[i2] = 1'b1;</font>
193                     
194                             // ETS / DWRR specific ...
195                             // Is the deficit counter for this queue &gt;= length of the frame at the head of the queue
196        1/1                  else if ((dwrr_en[i2] || ets_en[i2]) &amp;&amp; queue_can_tx_dwrr &amp;&amp; !(|queue_can_tx_str))
197        <font color = "red">0/1     ==>            queue_can_tx[i2] = 1'b1;</font>
198                     
199                             // Otherwise we cant transmit, but we can increment the deficit counters ...
200        1/1                  else if (dwrr_en[i2] || ets_en[i2])
201        <font color = "red">0/1     ==>            queue_can_tx[i2] = 1'b0;</font>
202                     
203                             // Non ETS/DWRR
204                             // In this case, we must be able to transmit, because there are frames available
205                             else
206        1/1                    queue_can_tx[i2] = 1'b1;
207                         end
208                     
209                         // Store the queue_can_tx bus. There will be times when more than one queue is allowed to transmit
210                         // We will loop through these in tuen in a round robin approach.
211                         // Also update the deficit counters here.  If ETS is enabled, the deficit counter is updated every 100
212                         // cycles, as the credit values passed in from the registers are percentage based.
213                         // For DWRR, the credit values are just weights, so we just update the counters every cycle.
214                         always @(*)
215                         begin
216        1/1                if (reschedule_now &amp; i2[3:0] == scheduled_queue)
217        1/1                  queue_can_tx_str_nxt[i2] = 1'b0;
218        1/1                else if (reschedule_now &amp; !(|queue_can_tx_str))
219        <font color = "red">0/1     ==>          queue_can_tx_str_nxt[i2] = queue_can_tx_dwrr;</font>
220                           else
221        1/1                  queue_can_tx_str_nxt[i2] = queue_can_tx_str[i2];
222                         end
223                     
224                         always@(posedge tx_r_clk or negedge tx_r_rst_n)
225                         begin
226        1/1                if (~tx_r_rst_n)
227                           begin
228        1/1                    dwrr_def_cnt[i2] &lt;= 16'h0000;
229                           end
230        1/1                else if (complete_flush)
231                           begin
232        1/1                    dwrr_def_cnt[i2] &lt;= 16'h0000;
233                           end
234                           else
235                           begin
236        1/1                  if (deficit_cntr_rst[i2])
237        1/1                    dwrr_def_cnt[i2] &lt;= 16'h0000;
238                     
239        1/1                  else if (!gatestate[i2] || (byte_count_arr[i2] &lt; {5'b00000,nxt_frame_size[i2]}))
240        <font color = "red">0/1     ==>            dwrr_def_cnt[i2] &lt;= dwrr_def_cnt[i2];</font>
241                     
242        1/1                  else if (dwrr_en[i2]|ets_en[i2])
243                             begin
244        <font color = "red">0/1     ==>            if (|dwrr_def_cnt_sat) // if any of the queues have saturated ...</font>
245        <font color = "red">0/1     ==>              dwrr_def_cnt[i2] &lt;= dwrr_def_cnt_add[16:1];</font>
246                               else
247        <font color = "red">0/1     ==>              dwrr_def_cnt[i2] &lt;= dwrr_def_cnt_add[15:0];</font>
248                             end
                        MISSING_ELSE
249                           end
250                         end
251                     
252                         always @(*)
253                         begin
254        1/1                if (reschedule_now &amp;&amp; (i2[3:0] == scheduled_queue))
255        1/1                  dwrr_def_cnt_sub = dwrr_def_cnt[i2] - {2'd0,nxt_frame_size[i2]};
256                           else
257        1/1                  dwrr_def_cnt_sub = dwrr_def_cnt[i2];
258                     
259        1/1                if  ((update_ets_credit &amp; ets_en[i2]) | (!(|queue_can_tx) &amp;&amp; dwrr_en[i2] &amp;&amp; !(|queue_can_tx_str) ))
260        <font color = "red">0/1     ==>          dwrr_def_cnt_add = dwrr_def_cnt_sub + dwrr_quantum[i2];</font>
261                           else
262        1/1                  dwrr_def_cnt_add = {1'b0,dwrr_def_cnt_sub};
263                         end
264                         assign dwrr_def_cnt_sat[i2] = dwrr_def_cnt_add[16];
265                     
266                       end
267                       endgenerate
268                     
269                       assign any_ets_en = |ets_en;
270                     
271                       // For ETS, we need a counter that triggers every 100 or 200 cycles ...
272                       always@(posedge tx_r_clk or negedge tx_r_rst_n)
273                       begin
274        1/1              if (~tx_r_rst_n)
275                         begin
276        1/1                update_ets_credit &lt;= 1'b0;
277        1/1                queue_can_tx_str  &lt;= {p_edma_queues{1'b0}};
278                         end
279        1/1              else if (complete_flush)
280                         begin
281        1/1                update_ets_credit &lt;= 1'b0;
282        1/1                queue_can_tx_str  &lt;= {p_edma_queues{1'b0}};
283                         end
284                         else
285                         begin
286        1/1                if (any_ets_en)
287                           begin
288                             // Now we dont want to update the ETS credits if a queue that has an higher index to the ETS queues
289                             // is currently transmitting. If we dont block this, the credits for all the lower ETS queues will
290                             // continue to increment ...
291                             // if top queue is fixed priority, and queue that is transmitting is fixed priority, then stop the credit
292                             // counter ...
293        <font color = "red">0/1     ==>          if ((scheduled_queue &gt; top_ets_queue) &amp; queue_is_fp)</font>
294        <font color = "red">0/1     ==>            update_ets_credit &lt;= 1'b0;</font>
295                             else
296        <font color = "red">0/1     ==>            update_ets_credit &lt;= ets_credits_upd_tog;</font>
297                           end
                        MISSING_ELSE
298                     
299        1/1                queue_can_tx_str  &lt;= queue_can_tx_str_nxt;
300                         end
301                       end
302                     
303                       assign nothing_to_xmit = !(|queue_can_tx);
304                     
305                       // Set the queue ID based on the above queue_can_tx bus ...
306                       // Pick the queue with the highest priority index in queue_can_tx
307                       integer queue_sel_cnt;
308                       always@(*)
309                       begin
310        1/1              scheduled_queue = 4'h0;
311        1/1              queue_is_fp     = 1'b0;
312        1/1              top_ets_queue   = 4'h0;
313                     
314                         // Basically we can just look at queue_can_tx here. However the problem with doing that
315                         // is that for ETS, the credit will continue to increment on all queues, even if the current
316                         // queue transmitting is fixed priority. Identify if the queue being selected is fixed
317                         // priority and use that to block the queue.  Also identify the top ETS queue.
318        1/1              for (queue_sel_cnt= 0; queue_sel_cnt&lt;p_edma_queues[4:0]; queue_sel_cnt=queue_sel_cnt+ 1)
319                         begin
320                           // Identify which is the top ETS queue
321        1/1                if (ets_en[queue_sel_cnt])
322        <font color = "red">0/1     ==>          top_ets_queue     = queue_sel_cnt;</font>
                        MISSING_ELSE
323                     
324        1/1                if (queue_can_tx[queue_sel_cnt])  // Fixed priority - highest queue num wins ...
325                           begin
326        1/1                  scheduled_queue = queue_sel_cnt;
327        1/1                  queue_is_fp     = ! (cbs_enable_q_a &amp;&amp; (queue_sel_cnt[3:0] == cbs_q_a_id)) &amp;&amp;
328                                               ! (cbs_enable_q_b &amp;&amp; (queue_sel_cnt[3:0]  == cbs_q_b_id)) &amp;&amp;
329                                               ! (dwrr_en[queue_sel_cnt] || ets_en[queue_sel_cnt]);
330                           end
                        MISSING_ELSE
</pre>
<hr>
<a name="Cond"></a>
Cond Coverage for Module : <a href="mod165.html" >edma_tx_sched</a><br clear=all>
<table class="noborder">
<col width="122">
<col span="3" width="82">
<tr><th></th><th>Total</th><th>Covered</th><th>Percent</th></tr>
<tr class="s2"><td class="lf">Conditions</td><td>22</td><td>6</td><td>27.27</td></tr>
<tr class="s2"><td class="lf">Logical</td><td>22</td><td>6</td><td>27.27</td></tr>
<tr class="wht"><td class="lf">Non-Logical</td><td>0</td><td>0</td><td></td></tr>
<tr class="wht"><td class="lf">Event</td><td>0</td><td>0</td><td></td></tr>
</table>
<br clear=all>
<pre class="code"> LINE       145
 EXPRESSION (dwrr_ets_control[((0 * 2) + 1)] &amp;&amp; ((!dwrr_ets_control[(0 * 2)])))
             ---------------1---------------    ---------------2--------------
</pre>
<table class="noborder">
<col span="2" width="40">
<tr><th>-1-</th><th>-2-</th><th>Status</th>                      </tr>
<tr class="uGreen"><td>0</td><td>1</td><td class="lf">Covered</td></tr>
<tr class="uRed"><td>1</td><td>0</td><td class="lf">Not Covered</td></tr>
<tr class="uRed"><td>1</td><td>1</td><td class="lf">Not Covered</td></tr>
</table>
<br clear=all>
<pre class="code"> LINE       146
 EXPRESSION (dwrr_ets_control[((0 * 2) + 1)] &amp;&amp; dwrr_ets_control[(0 * 2)])
             ---------------1---------------    ------------2------------
</pre>
<table class="noborder">
<col span="2" width="40">
<tr><th>-1-</th><th>-2-</th><th>Status</th>                      </tr>
<tr class="uRed"><td>0</td><td>1</td><td class="lf">Not Covered</td></tr>
<tr class="uRed"><td>1</td><td>0</td><td class="lf">Not Covered</td></tr>
<tr class="uRed"><td>1</td><td>1</td><td class="lf">Not Covered</td></tr>
</table>
<br clear=all>
<pre class="code"> LINE       196
 EXPRESSION ((dwrr_en[0] || ets_en[0]) &amp;&amp; gen_nxt_frame_size[0].queue_can_tx_dwrr &amp;&amp; ((!(|queue_can_tx_str))))
             ------------1------------    -------------------2-------------------    ------------3-----------
</pre>
<table class="noborder">
<col span="3" width="40">
<tr><th>-1-</th><th>-2-</th><th>-3-</th><th>Status</th>                      </tr>
<tr class="uRed"><td>0</td><td>1</td><td>1</td><td class="lf">Not Covered</td></tr>
<tr class="uRed"><td>1</td><td>0</td><td>1</td><td class="lf">Not Covered</td></tr>
<tr class="uRed"><td>1</td><td>1</td><td>0</td><td class="lf">Not Covered</td></tr>
<tr class="uRed"><td>1</td><td>1</td><td>1</td><td class="lf">Not Covered</td></tr>
</table>
<br clear=all>
<pre class="code"> LINE       196
 SUB-EXPRESSION (dwrr_en[0] || ets_en[0])
                 -----1----    ----2----
</pre>
<table class="noborder">
<col span="2" width="40">
<tr><th>-1-</th><th>-2-</th><th>Status</th>                      </tr>
<tr class="uGreen"><td>0</td><td>0</td><td class="lf">Covered</td></tr>
<tr class="uRed"><td>0</td><td>1</td><td class="lf">Not Covered</td></tr>
<tr class="uRed"><td>1</td><td>0</td><td class="lf">Not Covered</td></tr>
</table>
<br clear=all>
<pre class="code"> LINE       200
 EXPRESSION (dwrr_en[0] || ets_en[0])
             -----1----    ----2----
</pre>
<table class="noborder">
<col span="2" width="40">
<tr><th>-1-</th><th>-2-</th><th>Status</th>                      </tr>
<tr class="uGreen"><td>0</td><td>0</td><td class="lf">Covered</td></tr>
<tr class="uRed"><td>0</td><td>1</td><td class="lf">Not Covered</td></tr>
<tr class="uRed"><td>1</td><td>0</td><td class="lf">Not Covered</td></tr>
</table>
<br clear=all>
<pre class="code"> LINE       239
 EXPRESSION (((!gatestate[0])) || (byte_count_arr[0] &lt; {5'b0, nxt_frame_size[0]}))
             --------1--------    -----------------------2-----------------------
</pre>
<table class="noborder">
<col span="2" width="40">
<tr><th>-1-</th><th>-2-</th><th>Status</th>                      </tr>
<tr class="uGreen"><td>0</td><td>0</td><td class="lf">Covered</td></tr>
<tr class="uRed"><td>0</td><td>1</td><td class="lf">Not Covered</td></tr>
<tr class="uRed"><td>1</td><td>0</td><td class="lf">Not Covered</td></tr>
</table>
<br clear=all>
<pre class="code"> LINE       254
 EXPRESSION (reschedule_now &amp;&amp; (0[3:0] == scheduled_queue))
             -------1------    -------------2-------------
</pre>
<table class="noborder">
<col span="2" width="40">
<tr><th>-1-</th><th>-2-</th><th>Status</th>                      </tr>
<tr class="uGreen"><td>0</td><td>1</td><td class="lf">Covered</td></tr>
<tr class="uRed"><td>1</td><td>0</td><td class="lf">Not Covered</td></tr>
<tr class="uGreen"><td>1</td><td>1</td><td class="lf">Covered</td></tr>
</table>
<hr>
<a name="Toggle"></a>
Toggle Coverage for Module : <a href="mod165.html" >edma_tx_sched</a><br clear=all>
<table align=left class="noborder">
<tr>
<th nowrap width=120></th><th nowrap width=80>Total</th><th nowrap width=80>Covered</th><th nowrap width=80>Percent</th></tr><tr class="s2">
<td>Totals</td>
<td class="rt">25</td>
<td class="rt">6</td>
<td class="rt">24.00 </td>
</tr><tr class="s0">
<td>Total Bits</td>
<td class="rt">632</td>
<td class="rt">22</td>
<td class="rt">3.48  </td>
</tr><tr class="s0">
<td nowrap>Total Bits 0->1</td>
<td class="rt">316</td>
<td class="rt">13</td>
<td class="rt">4.11  </td>
</tr><tr class="s0">
<td nowrap>Total Bits 1->0</td>
<td class="rt">316</td>
<td class="rt">9</td>
<td class="rt">2.85  </td>
</tr></table><br clear=all>
<table align=left class="noborder">
<tr>
<th nowrap width=120></th><th nowrap width=80></th><th nowrap width=80></th><th nowrap width=80></th></tr><tr class="s2">
<td>Ports</td>
<td class="rt">25</td>
<td class="rt">6</td>
<td class="rt">24.00 </td>
</tr><tr class="s0">
<td>Port Bits</td>
<td class="rt">632</td>
<td class="rt">22</td>
<td class="rt">3.48  </td>
</tr><tr class="s0">
<td nowrap>Port Bits 0->1</td>
<td class="rt">316</td>
<td class="rt">13</td>
<td class="rt">4.11  </td>
</tr><tr class="s0">
<td nowrap>Port Bits 1->0</td>
<td class="rt">316</td>
<td class="rt">9</td>
<td class="rt">2.85  </td>
</tr></table><br clear=all>
<table align=left class="sortable noborder">
<caption><b>Port Details</b></caption>
<tr class="sortablehead">
<td class="alfsrt">Name</td><td class="alfsrt">Toggle</td><td class="alfsrt">Toggle 1->0</td><td class="alfsrt">Toggle 0->1</td><td class="alfsrt">Direction</td></tr><tr>
<td>tx_r_clk</td>
<td class="s9 cl">Yes</td>
<td class="s9 cl">Yes</td>
<td class="s9 cl">Yes</td>
<td>INPUT</td>
</tr><tr>
<td>tx_r_rst_n</td>
<td class="s3 cl">No</td>
<td class="s3 cl">No</td>
<td class="s9 cl">Yes</td>
<td>INPUT</td>
</tr><tr>
<td>complete_flush</td>
<td class="s3 cl">No</td>
<td class="s9 cl">Yes</td>
<td class="s3 cl">No</td>
<td>INPUT</td>
</tr><tr>
<td>packets_in_q</td>
<td class="s9 cl">Yes</td>
<td class="s9 cl">Yes</td>
<td class="s9 cl">Yes</td>
<td>INPUT</td>
</tr><tr>
<td>packets_in_q_nxt</td>
<td class="s9 cl">Yes</td>
<td class="s9 cl">Yes</td>
<td class="s9 cl">Yes</td>
<td>INPUT</td>
</tr><tr>
<td>byte_count[18:0]</td>
<td class="s3 cl">No</td>
<td class="s3 cl">No</td>
<td class="s3 cl">No</td>
<td>INPUT</td>
</tr><tr>
<td>gatestate</td>
<td class="s3 cl">No</td>
<td class="s3 cl">No</td>
<td class="s3 cl">No</td>
<td>INPUT</td>
</tr><tr>
<td>nxt_frame_size_bus[1:0]</td>
<td class="s3 cl">No</td>
<td class="s3 cl">No</td>
<td class="s9 cl">Yes</td>
<td>INPUT</td>
</tr><tr>
<td>nxt_frame_size_bus[2]</td>
<td class="s3 cl">No</td>
<td class="s9 cl">Yes</td>
<td class="s3 cl">No</td>
<td>INPUT</td>
</tr><tr>
<td>nxt_frame_size_bus[3]</td>
<td class="s3 cl">No</td>
<td class="s3 cl">No</td>
<td class="s9 cl">Yes</td>
<td>INPUT</td>
</tr><tr>
<td>nxt_frame_size_bus[4]</td>
<td class="s3 cl">No</td>
<td class="s9 cl">Yes</td>
<td class="s3 cl">No</td>
<td>INPUT</td>
</tr><tr>
<td>nxt_frame_size_bus[7:5]</td>
<td class="s3 cl">No</td>
<td class="s3 cl">No</td>
<td class="s9 cl">Yes</td>
<td>INPUT</td>
</tr><tr>
<td>nxt_frame_size_bus[13:8]</td>
<td class="s3 cl">No</td>
<td class="s3 cl">No</td>
<td class="s3 cl">No</td>
<td>INPUT</td>
</tr><tr>
<td>reschedule_now</td>
<td class="s9 cl">Yes</td>
<td class="s9 cl">Yes</td>
<td class="s9 cl">Yes</td>
<td>INPUT</td>
</tr><tr>
<td>cbs_dma_q_a</td>
<td class="s3 cl">No</td>
<td class="s3 cl">No</td>
<td class="s3 cl">No</td>
<td>INPUT</td>
</tr><tr>
<td>cbs_dma_q_b</td>
<td class="s3 cl">No</td>
<td class="s3 cl">No</td>
<td class="s3 cl">No</td>
<td>INPUT</td>
</tr><tr>
<td>mac_txing_dma_frame</td>
<td class="s9 cl">Yes</td>
<td class="s9 cl">Yes</td>
<td class="s9 cl">Yes</td>
<td>INPUT</td>
</tr><tr>
<td>ets_credits_upd_tog</td>
<td class="s3 cl">No</td>
<td class="s3 cl">No</td>
<td class="s3 cl">No</td>
<td>INPUT</td>
</tr><tr>
<td>cbs_q_a_id[3:0]</td>
<td class="s3 cl">No</td>
<td class="s3 cl">No</td>
<td class="s3 cl">No</td>
<td>INPUT</td>
</tr><tr>
<td>cbs_q_b_id[3:0]</td>
<td class="s3 cl">No</td>
<td class="s3 cl">No</td>
<td class="s3 cl">No</td>
<td>INPUT</td>
</tr><tr>
<td>idleslope_q_a[31:0]</td>
<td class="s3 cl">No</td>
<td class="s3 cl">No</td>
<td class="s3 cl">No</td>
<td>INPUT</td>
</tr><tr>
<td>idleslope_q_b[31:0]</td>
<td class="s3 cl">No</td>
<td class="s3 cl">No</td>
<td class="s3 cl">No</td>
<td>INPUT</td>
</tr><tr>
<td>port_tx_rate[31:0]</td>
<td class="s3 cl">No</td>
<td class="s3 cl">No</td>
<td class="s3 cl">No</td>
<td>INPUT</td>
</tr><tr>
<td>dwrr_ets_control[31:0]</td>
<td class="s3 cl">No</td>
<td class="s3 cl">No</td>
<td class="s3 cl">No</td>
<td>INPUT</td>
</tr><tr>
<td>bw_rate_limit[127:0]</td>
<td class="s3 cl">No</td>
<td class="s3 cl">No</td>
<td class="s3 cl">No</td>
<td>INPUT</td>
</tr><tr>
<td>cbs_enable_q_a</td>
<td class="s3 cl">No</td>
<td class="s3 cl">No</td>
<td class="s3 cl">No</td>
<td>INPUT</td>
</tr><tr>
<td>cbs_enable_q_b</td>
<td class="s3 cl">No</td>
<td class="s3 cl">No</td>
<td class="s3 cl">No</td>
<td>INPUT</td>
</tr><tr>
<td>nothing_to_xmit</td>
<td class="s9 cl">Yes</td>
<td class="s9 cl">Yes</td>
<td class="s9 cl">Yes</td>
<td>OUTPUT</td>
</tr><tr>
<td>any_ets_en</td>
<td class="s3 cl">No</td>
<td class="s3 cl">No</td>
<td class="s3 cl">No</td>
<td>OUTPUT</td>
</tr><tr>
<td>scheduled_queue[3:0]</td>
<td class="s3 cl">No</td>
<td class="s3 cl">No</td>
<td class="s3 cl">No</td>
<td>OUTPUT</td>
</tr></table><br clear=all>
<hr>
<a name="Branch"></a>
Branch Coverage for Module : <a href="mod165.html" >edma_tx_sched</a><br clear=all>
<table align=left class="noborder">
<tr>
<th nowrap width=120></th><th nowrap width=80>Line No.</th><th nowrap width=80>Total</th><th nowrap width=80>Covered</th><th nowrap width=80>Percent</th></tr><tr class="s5">
<td>Branches</td>
<td></td>
<td class="rt">27</td>
<td class="rt">14</td>
<td class="rt">51.85 </td>
</tr><tr class="s6">
<td>IF</td>
<td class="rt">274</td>
<td class="rt">5</td>
<td class="rt">3</td>
<td class="rt">60.00 </td>
</tr><tr class="s2">
<td>IF</td>
<td class="rt">164</td>
<td class="rt">8</td>
<td class="rt">2</td>
<td class="rt">25.00 </td>
</tr><tr class="s6">
<td>IF</td>
<td class="rt">216</td>
<td class="rt">3</td>
<td class="rt">2</td>
<td class="rt">66.67 </td>
</tr><tr class="s5">
<td>IF</td>
<td class="rt">226</td>
<td class="rt">7</td>
<td class="rt">4</td>
<td class="rt">57.14 </td>
</tr><tr class="s10">
<td>IF</td>
<td class="rt">254</td>
<td class="rt">2</td>
<td class="rt">2</td>
<td class="rt">100.00</td>
</tr><tr class="s5">
<td>IF</td>
<td class="rt">259</td>
<td class="rt">2</td>
<td class="rt">1</td>
<td class="rt">50.00 </td>
</tr></table><br clear=all>
<pre class="code"><br clear=all>
274            if (~tx_r_rst_n)
               <font color = "green">-1-</font>  
275            begin
276              update_ets_credit <= 1'b0;
           <font color = "green">      ==></font>
277              queue_can_tx_str  <= {p_edma_queues{1'b0}};
278            end
279            else if (complete_flush)
                    <font color = "green">-2-</font>  
280            begin
281              update_ets_credit <= 1'b0;
           <font color = "green">      ==></font>
282              queue_can_tx_str  <= {p_edma_queues{1'b0}};
283            end
284            else
285            begin
286              if (any_ets_en)
                 <font color = "red">-3-</font>  
287              begin
288                // Now we dont want to update the ETS credits if a queue that has an higher index to the ETS queues
289                // is currently transmitting. If we dont block this, the credits for all the lower ETS queues will
290                // continue to increment ...
291                // if top queue is fixed priority, and queue that is transmitting is fixed priority, then stop the credit
292                // counter ...
293                if ((scheduled_queue > top_ets_queue) & queue_is_fp)
                   <font color = "red">-4-</font>  
294                  update_ets_credit <= 1'b0;
           <font color = "red">          ==></font>
295                else
296                  update_ets_credit <= ets_credits_upd_tog;
           <font color = "red">          ==></font>
297              end
                 MISSING_ELSE
           <font color = "green">      ==></font>
</pre>
<br clear=all>
<span class=repname>Branches:</span>
<br clear=all>
<table align=left class="noborder">
<tr>
<th nowrap width=80>-1-</th><th nowrap width=80>-2-</th><th nowrap width=80>-3-</th><th nowrap width=80>-4-</th><th nowrap width=80>Status</th></tr><tr class="uGreen">
<td align=center>1</td>
<td align=center nowrap>-</td>
<td align=center nowrap>-</td>
<td align=center nowrap>-</td>
<td>Covered</td>
</tr><tr class="uGreen">
<td align=center>0</td>
<td align=center>1</td>
<td align=center nowrap>-</td>
<td align=center nowrap>-</td>
<td>Covered</td>
</tr><tr class="uRed">
<td align=center>0</td>
<td align=center>0</td>
<td align=center>1</td>
<td align=center>1</td>
<td>Not Covered</td>
</tr><tr class="uRed">
<td align=center>0</td>
<td align=center>0</td>
<td align=center>1</td>
<td align=center>0</td>
<td>Not Covered</td>
</tr><tr class="uGreen">
<td align=center>0</td>
<td align=center>0</td>
<td align=center>0</td>
<td align=center nowrap>-</td>
<td>Covered</td>
</tr></table><br clear=all>
<pre class="code"><br clear=all>
164                if (!gatestate[i2] | ({byte_count_arr[i2]} < {5'b00000,nxt_frame_size[i2]}))
                   <font color = "red">-1-</font>  
165                begin
166                  queue_can_tx[i2] = 1'b0;
           <font color = "red">          ==></font>
167                  deficit_cntr_rst[i2] = (!packets_in_q[i2]);
168                end
169        
170                // If there are no frames to transmit, then we cannot transmit obviously ...
171                // We also need to reset the deficit counters if there are no frames ...
172                else if (!packets_in_q[i2])
                        <font color = "green">-2-</font>  
173                begin
174                  queue_can_tx[i2] = 1'b0;
           <font color = "green">          ==></font>
175                  deficit_cntr_rst[i2] = 1'b1;
176                end
177        
178                // CBS Specific
179                // If CBS is enabled on the top queue, then only allow transmission to
180                // continue if the CBS module permits it ...
181                else if (cbs_q_a_id == i2[3:0] & cbs_enable_q_a)
                        <font color = "red">-3-</font>  
182                  queue_can_tx[i2] = cbs_queue[0];
           <font color = "red">          ==></font>
183        
184                // If CBS is enabled on 2nd top queue, then only allow transmission to
185                // continue if the CBS module permits it ...
186                else if (cbs_q_b_id == i2[3:0] & cbs_enable_q_b)
                        <font color = "red">-4-</font>  
187                  queue_can_tx[i2] = cbs_queue[1];
           <font color = "red">          ==></font>
188        
189                // Have we previously said we can send a frame on this queue and are still waiting for it to be serviced ?
190                // If so, then we can transmit
191                else if (queue_can_tx_str[i2])
                        <font color = "red">-5-</font>  
192                  queue_can_tx[i2] = 1'b1;
           <font color = "red">          ==></font>
193        
194                // ETS / DWRR specific ...
195                // Is the deficit counter for this queue >= length of the frame at the head of the queue
196                else if ((dwrr_en[i2] || ets_en[i2]) && queue_can_tx_dwrr && !(|queue_can_tx_str))
                        <font color = "red">-6-</font>  
197                  queue_can_tx[i2] = 1'b1;
           <font color = "red">          ==></font>
198        
199                // Otherwise we cant transmit, but we can increment the deficit counters ...
200                else if (dwrr_en[i2] || ets_en[i2])
                        <font color = "red">-7-</font>  
201                  queue_can_tx[i2] = 1'b0;
           <font color = "red">          ==></font>
202        
203                // Non ETS/DWRR
204                // In this case, we must be able to transmit, because there are frames available
205                else
206                  queue_can_tx[i2] = 1'b1;
           <font color = "green">          ==></font>
</pre>
<br clear=all>
<span class=repname>Branches:</span>
<br clear=all>
<table align=left class="noborder">
<tr>
<th nowrap width=80>-1-</th><th nowrap width=80>-2-</th><th nowrap width=80>-3-</th><th nowrap width=80>-4-</th><th nowrap width=80>-5-</th><th nowrap width=80>-6-</th><th nowrap width=80>-7-</th><th nowrap width=80>Status</th></tr><tr class="uRed">
<td align=center>1</td>
<td align=center nowrap>-</td>
<td align=center nowrap>-</td>
<td align=center nowrap>-</td>
<td align=center nowrap>-</td>
<td align=center nowrap>-</td>
<td align=center nowrap>-</td>
<td>Not Covered</td>
</tr><tr class="uGreen">
<td align=center>0</td>
<td align=center>1</td>
<td align=center nowrap>-</td>
<td align=center nowrap>-</td>
<td align=center nowrap>-</td>
<td align=center nowrap>-</td>
<td align=center nowrap>-</td>
<td>Covered</td>
</tr><tr class="uRed">
<td align=center>0</td>
<td align=center>0</td>
<td align=center>1</td>
<td align=center nowrap>-</td>
<td align=center nowrap>-</td>
<td align=center nowrap>-</td>
<td align=center nowrap>-</td>
<td>Not Covered</td>
</tr><tr class="uRed">
<td align=center>0</td>
<td align=center>0</td>
<td align=center>0</td>
<td align=center>1</td>
<td align=center nowrap>-</td>
<td align=center nowrap>-</td>
<td align=center nowrap>-</td>
<td>Not Covered</td>
</tr><tr class="uRed">
<td align=center>0</td>
<td align=center>0</td>
<td align=center>0</td>
<td align=center>0</td>
<td align=center>1</td>
<td align=center nowrap>-</td>
<td align=center nowrap>-</td>
<td>Not Covered</td>
</tr><tr class="uRed">
<td align=center>0</td>
<td align=center>0</td>
<td align=center>0</td>
<td align=center>0</td>
<td align=center>0</td>
<td align=center>1</td>
<td align=center nowrap>-</td>
<td>Not Covered</td>
</tr><tr class="uRed">
<td align=center>0</td>
<td align=center>0</td>
<td align=center>0</td>
<td align=center>0</td>
<td align=center>0</td>
<td align=center>0</td>
<td align=center>1</td>
<td>Not Covered</td>
</tr><tr class="uGreen">
<td align=center>0</td>
<td align=center>0</td>
<td align=center>0</td>
<td align=center>0</td>
<td align=center>0</td>
<td align=center>0</td>
<td align=center>0</td>
<td>Covered</td>
</tr></table><br clear=all>
<pre class="code"><br clear=all>
216              if (reschedule_now & i2[3:0] == scheduled_queue)
                 <font color = "green">-1-</font>  
217                queue_can_tx_str_nxt[i2] = 1'b0;
           <font color = "green">        ==></font>
218              else if (reschedule_now & !(|queue_can_tx_str))
                      <font color = "red">-2-</font>  
219                queue_can_tx_str_nxt[i2] = queue_can_tx_dwrr;
           <font color = "red">        ==></font>
220              else
221                queue_can_tx_str_nxt[i2] = queue_can_tx_str[i2];
           <font color = "green">        ==></font>
</pre>
<br clear=all>
<span class=repname>Branches:</span>
<br clear=all>
<table align=left class="noborder">
<tr>
<th nowrap width=80>-1-</th><th nowrap width=80>-2-</th><th nowrap width=80>Status</th></tr><tr class="uGreen">
<td align=center>1</td>
<td align=center nowrap>-</td>
<td>Covered</td>
</tr><tr class="uRed">
<td align=center>0</td>
<td align=center>1</td>
<td>Not Covered</td>
</tr><tr class="uGreen">
<td align=center>0</td>
<td align=center>0</td>
<td>Covered</td>
</tr></table><br clear=all>
<pre class="code"><br clear=all>
226              if (~tx_r_rst_n)
                 <font color = "green">-1-</font>  
227              begin
228                  dwrr_def_cnt[i2] <= 16'h0000;
           <font color = "green">          ==></font>
229              end
230              else if (complete_flush)
                      <font color = "green">-2-</font>  
231              begin
232                  dwrr_def_cnt[i2] <= 16'h0000;
           <font color = "green">          ==></font>
233              end
234              else
235              begin
236                if (deficit_cntr_rst[i2])
                   <font color = "green">-3-</font>  
237                  dwrr_def_cnt[i2] <= 16'h0000;
           <font color = "green">          ==></font>
238        
239                else if (!gatestate[i2] || (byte_count_arr[i2] < {5'b00000,nxt_frame_size[i2]}))
                        <font color = "red">-4-</font>  
240                  dwrr_def_cnt[i2] <= dwrr_def_cnt[i2];
           <font color = "red">          ==></font>
241        
242                else if (dwrr_en[i2]|ets_en[i2])
                        <font color = "red">-5-</font>  
243                begin
244                  if (|dwrr_def_cnt_sat) // if any of the queues have saturated ...
                     <font color = "red">-6-</font>  
245                    dwrr_def_cnt[i2] <= dwrr_def_cnt_add[16:1];
           <font color = "red">            ==></font>
246                  else
247                    dwrr_def_cnt[i2] <= dwrr_def_cnt_add[15:0];
           <font color = "red">            ==></font>
248                end
                   MISSING_ELSE
           <font color = "green">        ==></font>
</pre>
<br clear=all>
<span class=repname>Branches:</span>
<br clear=all>
<table align=left class="noborder">
<tr>
<th nowrap width=80>-1-</th><th nowrap width=80>-2-</th><th nowrap width=80>-3-</th><th nowrap width=80>-4-</th><th nowrap width=80>-5-</th><th nowrap width=80>-6-</th><th nowrap width=80>Status</th></tr><tr class="uGreen">
<td align=center>1</td>
<td align=center nowrap>-</td>
<td align=center nowrap>-</td>
<td align=center nowrap>-</td>
<td align=center nowrap>-</td>
<td align=center nowrap>-</td>
<td>Covered</td>
</tr><tr class="uGreen">
<td align=center>0</td>
<td align=center>1</td>
<td align=center nowrap>-</td>
<td align=center nowrap>-</td>
<td align=center nowrap>-</td>
<td align=center nowrap>-</td>
<td>Covered</td>
</tr><tr class="uGreen">
<td align=center>0</td>
<td align=center>0</td>
<td align=center>1</td>
<td align=center nowrap>-</td>
<td align=center nowrap>-</td>
<td align=center nowrap>-</td>
<td>Covered</td>
</tr><tr class="uRed">
<td align=center>0</td>
<td align=center>0</td>
<td align=center>0</td>
<td align=center>1</td>
<td align=center nowrap>-</td>
<td align=center nowrap>-</td>
<td>Not Covered</td>
</tr><tr class="uRed">
<td align=center>0</td>
<td align=center>0</td>
<td align=center>0</td>
<td align=center>0</td>
<td align=center>1</td>
<td align=center>1</td>
<td>Not Covered</td>
</tr><tr class="uRed">
<td align=center>0</td>
<td align=center>0</td>
<td align=center>0</td>
<td align=center>0</td>
<td align=center>1</td>
<td align=center>0</td>
<td>Not Covered</td>
</tr><tr class="uGreen">
<td align=center>0</td>
<td align=center>0</td>
<td align=center>0</td>
<td align=center>0</td>
<td align=center>0</td>
<td align=center nowrap>-</td>
<td>Covered</td>
</tr></table><br clear=all>
<pre class="code"><br clear=all>
254              if (reschedule_now && (i2[3:0] == scheduled_queue))
                 <font color = "green">-1-</font>  
255                dwrr_def_cnt_sub = dwrr_def_cnt[i2] - {2'd0,nxt_frame_size[i2]};
           <font color = "green">        ==></font>
256              else
257                dwrr_def_cnt_sub = dwrr_def_cnt[i2];
           <font color = "green">        ==></font>
</pre>
<br clear=all>
<span class=repname>Branches:</span>
<br clear=all>
<table align=left class="noborder">
<tr>
<th nowrap width=80>-1-</th><th nowrap width=80>Status</th></tr><tr class="uGreen">
<td align=center>1</td>
<td>Covered</td>
</tr><tr class="uGreen">
<td align=center>0</td>
<td>Covered</td>
</tr></table><br clear=all>
<pre class="code"><br clear=all>
259              if  ((update_ets_credit & ets_en[i2]) | (!(|queue_can_tx) && dwrr_en[i2] && !(|queue_can_tx_str) ))
                 <font color = "red">-1-</font>  
260                dwrr_def_cnt_add = dwrr_def_cnt_sub + dwrr_quantum[i2];
           <font color = "red">        ==></font>
261              else
262                dwrr_def_cnt_add = {1'b0,dwrr_def_cnt_sub};
           <font color = "green">        ==></font>
</pre>
<br clear=all>
<span class=repname>Branches:</span>
<br clear=all>
<table align=left class="noborder">
<tr>
<th nowrap width=80>-1-</th><th nowrap width=80>Status</th></tr><tr class="uRed">
<td align=center>1</td>
<td>Not Covered</td>
</tr><tr class="uGreen">
<td align=center>0</td>
<td>Covered</td>
</tr></table><br clear=all>
</div>
</div>
<div class="ui-layout-center-inner-north">
<div id="center-bread-crumb" class="breadCrumb module urg-margin-bottom">
  <ul name="tag_edma_tx_sched">
    <li>
      <a href="#Line">Line</a>    </li>
    <li>
      <a href="#Cond">Cond</a>    </li>
    <li>
      <a href="#Toggle">Toggle</a>    </li>
    <li>
      <a href="#Branch">Branch</a>    </li>
  </ul>
</div>
</div>
</div>
<div class="ui-layout-south">
<table align=center><tr><td class="s0 cl">0%</td>
<td class="s1 cl">10%</td>
<td class="s2 cl">20%</td>
<td class="s3 cl">30%</td>
<td class="s4 cl">40%</td>
<td class="s5 cl">50%</td>
<td class="s6 cl">60%</td>
<td class="s7 cl">70%</td>
<td class="s8 cl">80%</td>
<td class="s9 cl">90%</td>
<td class="s10 cl">100%</td></tr></table></div>
</body>
</html>
